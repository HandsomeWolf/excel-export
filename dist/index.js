"use strict";var d=Object.create;var a=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var w=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var S=(s,e)=>{for(var t in e)a(s,t,{get:e[t],enumerable:!0})},g=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of C(e))!x.call(s,o)&&o!==t&&a(s,o,{get:()=>e[o],enumerable:!(r=k(e,o))||r.enumerable});return s};var m=(s,e,t)=>(t=s!=null?d(w(s)):{},g(e||!s||!s.__esModule?a(t,"default",{value:s,enumerable:!0}):t,s)),W=s=>g(a({},"__esModule",{value:!0}),s);var A={};S(A,{excelExport:()=>R});module.exports=W(A);var p=m(require("exceljs")),y=m(require("file-saver"));var c={header:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FF12BA83"}},font:{name:"\u5FAE\u8F6F\u96C5\u9ED1",size:12,color:{argb:"FFFFFFFF"},bold:!0},border:{top:{style:"thin",color:{argb:"FF28C593"}},left:{style:"thin",color:{argb:"FF28C593"}},bottom:{style:"thin",color:{argb:"FF28C593"}},right:{style:"thin",color:{argb:"FF28C593"}}},alignment:{vertical:"middle",horizontal:"center"}},body:{font:{name:"\u5FAE\u8F6F\u96C5\u9ED1",size:12,color:{argb:"FF333333"}},border:{top:{style:"thin",color:{argb:"FFD6D8D7"}},left:{style:"thin",color:{argb:"FFD6D8D7"}},bottom:{style:"thin",color:{argb:"FFD6D8D7"}},right:{style:"thin",color:{argb:"FFD6D8D7"}}},alignment:{vertical:"middle",horizontal:"center"}}};function b(s){return!/[^\u4E00-\u9FA5]/.test(s)}function F(s){return!/\D/.test(s)}var h=class{constructor(){this.workbook=new p.default.Workbook}createSheet(e){return this.workbook.addWorksheet(e)}insertHeader(e,t){let r=e.addRow(t);r.eachCell(o=>{o.style=c.header}),r.height=34}insertData(e,t,r){for(let o of r){if(t.length>o.length)for(let n=0;n<t.length-o.length;n++)o.push("-");for(let n=0;n<o.length;n++)(o[n]===void 0||o[n]===null||o[n]==="")&&(o[n]="-")}e.addRows(r),e.eachRow((o,n)=>{n>1?(o.eachCell(l=>{l.style={...l.style,...c.body}}),o.height=28):o.eachCell(l=>{l.style={...c.header,numFmt:l.numFmt}})})}insertObjectData(e,t,r){let o=Object.keys(t),n=Object.values(t),l=r.map(i=>{let f=[];for(let u of o)i[u]===void 0?f.push("-"):f.push(i[u]);return f});this.insertHeader(e,n),this.insertData(e,o,l)}setAccountingFormat(e,t,r=2){if(e.eachRow(o=>{for(let n of t){let l=o.getCell(n);if(typeof l.value=="string"){let i=Number.parseFloat(l.value);Number.isNaN(i)||(l.value=i)}}}),typeof r=="number"){let o=`\uFFE5#,##0.${"0".repeat(r)};\uFFE5-#,##0.${"0".repeat(r)};-`;for(let n of t)e.getColumn(n).numFmt=o}else if(Array.isArray(r))for(let[o,n]of t.entries()){let l=`\uFFE5#,##0.${"0".repeat(r[o])};\uFFE5-#,##0.${"0".repeat(r[o])};-`;e.getColumn(n).numFmt=l}}setSheetStyle(e,t){t.accountingColumns&&this.setAccountingFormat(e,t.accountingColumns),t.rowFontColor&&this.setRowFontColor(e,t.rowFontColor.rows,t.rowFontColor.defaultColor),t.rowBackgroundColors&&this.setRowEachBackgroundColor(e,t.rowBackgroundColors)}exportFile(e){this.workbook.xlsx.writeBuffer().then(t=>{(0,y.default)(new Blob([t],{type:"application/octet-stream"}),`${e}.xlsx`)})}autoFitColumn(e){for(let t of e.columns){let r=0;t.eachCell({includeEmpty:!0},o=>{let n=0;for(let l of o.text)n+=b(l)?3:F(l)?2.7:1.5;n>r&&(r=n)}),t.width=r<10?10:r}}setRowFontColor(e,t,r="FF0000"){for(let o of t)e.getRow(o+1).eachCell(n=>{n.font={...n.font,color:{argb:r.replace("#","")}}})}setRowBackgroundColor(e,t,r="f8fffd"){for(let o of t)e.getRow(o).eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:r.replace("#","")}}})}setRowEachBackgroundColor(e,t){e.eachRow((r,o)=>{o>1&&r.eachCell(n=>{let l=t[o-2];l&&(n.style.fill={type:"pattern",pattern:"solid",fgColor:{argb:l.startsWith("#")?`FF${l.slice(1)}`:l}})})})}};var R=(s,e)=>{let t=new h;for(let r of e){let o=t.createSheet(r.sheetName);Array.isArray(r.sheetRows[0])?D(o,r,t):E(o,r,t),t.autoFitColumn(o)}t.exportFile(s)},D=(s,e,t)=>{t.insertHeader(s,e.sheetHeader),t.insertData(s,e.sheetHeader,e.sheetRows),e.options&&t.setSheetStyle(s,e.options)},E=(s,e,t)=>{t.insertObjectData(s,e.sheetHeader,e.sheetRows),e.options&&t.setSheetStyle(s,e.options)};0&&(module.exports={excelExport});
