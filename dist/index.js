"use strict";var k=Object.create;var h=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var W=(n,e)=>{for(var t in e)h(n,t,{get:e[t],enumerable:!0})},u=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of w(e))!S.call(n,o)&&o!==t&&h(n,o,{get:()=>e[o],enumerable:!(r=C(e,o))||r.enumerable});return n};var d=(n,e,t)=>(t=n!=null?k(x(n)):{},u(e||!n||!n.__esModule?h(t,"default",{value:n,enumerable:!0}):t,n)),R=n=>u(h({},"__esModule",{value:!0}),n);var B={};W(B,{excelExport:()=>D});module.exports=R(B);var y=d(require("exceljs")),F=d(require("file-saver"));var f={header:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FF12BA83"}},font:{name:"\u5FAE\u8F6F\u96C5\u9ED1",size:12,color:{argb:"FFFFFFFF"},bold:!0},border:{top:{style:"thin",color:{argb:"FF28C593"}},left:{style:"thin",color:{argb:"FF28C593"}},bottom:{style:"thin",color:{argb:"FF28C593"}},right:{style:"thin",color:{argb:"FF28C593"}}},alignment:{vertical:"middle",horizontal:"center"}},body:{font:{name:"\u5FAE\u8F6F\u96C5\u9ED1",size:12,color:{argb:"FF6F7173"}},border:{top:{style:"thin",color:{argb:"FFD6D8D7"}},left:{style:"thin",color:{argb:"FFD6D8D7"}},bottom:{style:"thin",color:{argb:"FFD6D8D7"}},right:{style:"thin",color:{argb:"FFD6D8D7"}}},alignment:{vertical:"middle",horizontal:"center"}}};function p(n){return!/[^\u4E00-\u9FA5]/.test(n)}function b(n){return!/\D/.test(n)}var g=class{constructor(){this.workbook=new y.default.Workbook}createSheet(e){return this.workbook.addWorksheet(e)}insertHeader(e,t){let r=e.addRow(t);r.eachCell(o=>{o.style=f.header}),r.height=34}insertData(e,t,r){for(let o of r){if(t.length>o.length)for(let s=0;s<t.length-o.length;s++)o.push("-");for(let s=0;s<o.length;s++)(o[s]===void 0||o[s]===null||o[s]==="")&&(o[s]="-")}e.addRows(r),e.eachRow((o,s)=>{s>1?(o.eachCell(l=>{l.style={...l.style,...f.body}}),o.height=28):o.eachCell(l=>{l.style={...f.header,numFmt:l.numFmt}})})}insertObjectData(e,t,r){let o=Object.keys(t),s=Object.values(t),l=r.map(i=>{let a=[];for(let c of o)i[c]===void 0?a.push("-"):a.push(i[c]);return a});this.insertHeader(e,s),this.insertData(e,o,l)}setAccountingFormat(e,t,r=2){if(typeof r=="number"){let o=`\uFFE5#,##0.${"0".repeat(r)};\uFFE5(#,##0.${"0".repeat(r)});-`;for(let s of t)e.getColumn(s).numFmt=o}else if(Array.isArray(r))for(let[o,s]of t.entries()){let l=`\uFFE5#,##0.${"0".repeat(r[o])};\uFFE5(#,##0.${"0".repeat(r[o])});-`;e.getColumn(s).numFmt=l}}setSheetStyle(e,t){t.accountingColumns&&this.setAccountingFormat(e,t.accountingColumns),t.rowFontColor&&this.setRowFontColor(e,t.rowFontColor.rows,t.rowFontColor.defaultColor),t.rowBackgroundColors&&this.setRowBackgroundColor(e,t.rowBackgroundColors.rows,t.rowBackgroundColors.defaultColor)}exportFile(e){this.workbook.xlsx.writeBuffer().then(t=>{(0,F.default)(new Blob([t],{type:"application/octet-stream"}),`${e}.xlsx`)})}createSheetAndFillData(e,t,r){let o=this.workbook.addWorksheet(e),s=["fapiao","hetong","jine"].map((l,i)=>({header:["\u53D1\u7968","\u5408\u540C","\u91D1\u989D"][i],key:l}));o.columns=s;for(let l of r){let i=o.addRow([l.fapiao,l.hetong,l.jine]);i.eachCell(c=>{c.style={font:{color:{argb:l.other.color.replace("#","")}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:l.other.background.replace("#","")}}}});let a=i.getCell(3);a.numFmt="\xA5#,##0.00"}for(let l of o.columns){let i=0;l.eachCell({includeEmpty:!0},a=>{var m;let c=((m=a.text)==null?void 0:m.length)||0;c>i&&(i=c)}),l.width=i<10?10:i}}autoFitColumn(e){for(let t of e.columns){let r=0;t.eachCell({includeEmpty:!0},o=>{let s=0;for(let l of o.text)s+=p(l)?3:b(l)?2.7:1.5;s>r&&(r=s)}),t.width=r<10?10:r}}setRowFontColor(e,t,r="FF0000"){for(let o of t)e.getRow(o+1).eachCell(s=>{s.font={...s.font,color:{argb:r.replace("#","")}}})}setRowBackgroundColor(e,t,r="f8fffd"){for(let o of t)e.getRow(o).eachCell(s=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:r.replace("#","")}}})}setRowEachBackgroundColor(e,t){e.eachRow((r,o)=>{o>1&&(r.fill={type:"pattern",pattern:"solid",fgColor:{argb:t[o-2]}})})}};var D=(n,e)=>{let t=new g;for(let r of e){let o=t.createSheet(r.sheetName);Array.isArray(r.sheetRows[0])?E(o,r,t):A(o,r,t),t.autoFitColumn(o)}t.exportFile(n)},E=(n,e,t)=>{t.insertHeader(n,e.sheetHeader),t.insertData(n,e.sheetHeader,e.sheetRows),e.options&&t.setSheetStyle(n,e.options)},A=(n,e,t)=>{t.insertObjectData(n,e.sheetHeader,e.sheetRows),e.options&&t.setSheetStyle(n,e.options)};0&&(module.exports={excelExport});
